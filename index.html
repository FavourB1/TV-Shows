<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TV Shows Finder</title>
    <style>
        /* Overall Page Style */
        body {
            font-family: 'Georgia', serif;
            background-color: #2f1b0d;
            color: #f8f1e5;
            margin: 0;
            display: flex;
            justify-content: center;
            padding: 2em;
        }

        /* Retro Fantasy Theme Container */
        #tv-show-container {
            border: 2px solid #d4a373;
            padding: 2em;
            border-radius: 12px;
            max-width: 1000px;
            background-color: #4b3621;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            animation: glow 2s infinite alternate;
            text-align: center;
        }

        /* Animation for a Glowing Effect */
        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(255, 215, 0, 0.4); }
            to { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
        }

        /* Progress Bar */
        #progress-bar {
            width: 100%;
            background-color: #d4a373;
            border-radius: 5px;
            margin-bottom: 1em;
            overflow: hidden;
        }
        #progress {
            height: 10px;
            background-color: #ffeb3b;
            transition: width 0.5s ease;
        }

        /* Text and Button Styles */
        h2, p {
            color: #ffebcd;
            text-shadow: 1px 1px 2px #2f1b0d;
        }
        .rating-buttons label {
            margin-right: 10px;
            color: #f8f1e5;
            cursor: pointer;
        }
        button {
            padding: 0.7em 1.2em;
            margin-top: 1em;
            background-color: #d4a373;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            color: #2f1b0d;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #ffeb3b;
            color: #2f1b0d;
        }

        /* Chart Container */
        #result-container {
            margin-top: 2em;
            padding: 1em;
            border: 1px solid #d4a373;
            border-radius: 8px;
            background-color: #4b3621;
            color: #ffebcd;
            max-width: 1000px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div id="tv-show-container">
    <div id="progress-bar">
        <div id="progress" style="width: 0%;"></div>
    </div>
    <h2 id="tv-title">TV Show Title</h2>
    <p id="tv-author">Author: </p>
    <p id="tv-year">Year: </p>
    <p id="tv-genre">Genre: </p>
    <div class="rating-buttons">
        <label><input type="radio" name="rating" value="1"> 1</label>
        <label><input type="radio" name="rating" value="2"> 2</label>
        <label><input type="radio" name="rating" value="3"> 3</label>
        <label><input type="radio" name="rating" value="4"> 4</label>
        <label><input type="radio" name="rating" value="5"> 5</label>
        <label><input type="radio" name="rating" value="skip"> Haven't watched</label>
    </div>
    <button onclick="rateShow()">Rate</button>
    <button onclick="skipShow()">Skip</button>
</div>

<div id="result-container">
    <h3>Results</h3>
    <canvas id="genreChart" width="400" height="200"></canvas>
    <p>Top Genres Based on Ratings:</p>
    <ul id="top-genres"></ul>
    <button onclick="rateMoreShows()">Rate More Shows</button>
    <button onclick="finishRating()">Finish and View Recommendations</button>
</div>

<script>
    // Sample JSON data as an array of objects
    const tvShows = [
        {"title": "I Love Lucy", "author": "Desi Arnaz, Madelyn Pugh, Bob Carroll Jr.", "year": 1951, "genre": ["Sitcom", "Comedy"]},
        {"title": "The Twilight Zone", "author": "Rod Serling", "year": 1959, "genre": ["Sci-Fi", "Thriller"]},
        {"title": "Doctor Who", "author": "Sydney Newman", "year": 1963, "genre": ["Sci-Fi", "Adventure"]},
        {"title": "Star Trek", "author": "Gene Roddenberry", "year": 1966, "genre": ["Sci-Fi", "Adventure"]},
        // Add more TV shows up to 100
    ];

    let displayedShows = [];
    let ratedShows = [];
    let currentShowIndex = 0;
    const highRatingsPerGenre = {};
    const totalRatingsPerGenre = {};
    const ratingCountsPerGenre = {};

    function getRandomShows() {
        let availableShows = tvShows.filter(show => !ratedShows.includes(show.title));
        let shuffled = availableShows.sort(() => 0.5 - Math.random());
        displayedShows = shuffled.slice(0, 10);
        currentShowIndex = 0;
        updateProgressBar();
        displayShow();
    }

    function displayShow() {
        if (currentShowIndex >= displayedShows.length) {
            alert("You have rated all available shows in this round!");
            displayResults();
            return;
        }

        const show = displayedShows[currentShowIndex];
        document.getElementById("tv-title").textContent = show.title;
        document.getElementById("tv-author").textContent = "Author: " + show.author;
        document.getElementById("tv-year").textContent = "Year: " + show.year;
        document.getElementById("tv-genre").textContent = "Genre: " + show.genre.join(", ");
    }

    function rateShow() {
        const rating = document.querySelector('input[name="rating"]:checked')?.value;

        if (!rating) {
            alert("Please select a rating or choose 'Haven't watched'.");
            return;
        }

        if (rating !== "skip") {
            const show = displayedShows[currentShowIndex];
            show.genre.forEach(genre => {
                if (!highRatingsPerGenre[genre]) highRatingsPerGenre[genre] = 0;
                if (!totalRatingsPerGenre[genre]) totalRatingsPerGenre[genre] = 0;
                if (!ratingCountsPerGenre[genre]) ratingCountsPerGenre[genre] = 0;

                totalRatingsPerGenre[genre] += parseInt(rating);
                ratingCountsPerGenre[genre] += 1;

                if (parseInt(rating) >= 3) {
                    highRatingsPerGenre[genre] += 1;
                }
            });

            ratedShows.push(show.title);
        }

        currentShowIndex++;
        updateProgressBar();
        displayShow();
        document.querySelector('input[name="rating"]:checked').checked = false;
    }

    function skipShow() {
        currentShowIndex++;
        updateProgressBar();
        displayShow();
    }

    function updateProgressBar() {
        const progress = (currentShowIndex / displayedShows.length) * 100;
        document.getElementById("progress").style.width = `${progress}%`;
    }

    function displayResults() {
        const topGenres = Object.entries(highRatingsPerGenre)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 3);

        const genreChartCtx = document.getElementById('genreChart').getContext('2d');
        new Chart(genreChartCtx, {
            type: 'bar',
            data: {
                labels: topGenres.map(genre => genre[0]),
                datasets: [{
                    label: 'High Ratings Count',
                    data: topGenres.map(genre => genre[1]),
                    backgroundColor: ['#FF6347', '#32CD32', '#1E90FF'],
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
    }

    function rateMoreShows() {
        getRandomShows();
    }

    function finishRating() {
        alert("Thank you for rating! Your recommendations are ready.");
    }

    // Initialize
    getRandomShows
